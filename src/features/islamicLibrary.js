const { Content } = require('../database/models');

class IslamicLibrary {
  /**
   * Tafsir (Quranic Exegesis) Database
   */
  static async getTafsir(surahNumber, ayahNumber, tafsirSource = 'ุงูุณุนุฏู') {
    // This is a sample. In production, you'd connect to a tafsir API or database
    const tafsirs = {
      'ุงูุณุนุฏู': {
        1: {
          1: 'ุงูุญูุฏ ููู: ุงูุซูุงุก ุนูู ุงููู ุจุตูุงุช ุงูููุงู ููุนูุช ุงูุฌูุงูุ ุฑุจ ุงูุนุงูููู: ุงููุงูู ูุฌููุน ุงููุฎูููุงุชุ ุงููุฏุจุฑ ููุงุ ุงููุฑุจู ููุง ุจุฃููุงุน ุงูุชุฑุจูุฉ.'
        }
      },
      'ุงุจู ูุซูุฑ': {
        1: {
          1: 'ุงูุญูุฏ ููู ุฑุจ ุงูุนุงูููู: ูุฐู ุงูุณูุฑุฉ ูู ุฃู ุงููุฑุขู ูุฃู ุงููุชุงุจ ูุงูุณุจุน ุงููุซุงููุ ุงูุชุชุญูุง ุงููู ุจุงูุซูุงุก ุนูู ููุณู ุงููุฑููุฉ.'
        }
      },
      'ุงูุทุจุฑู': {
        1: {
          1: 'ุงูุญูุฏ ููู ุฑุจ ุงูุนุงูููู: ุงูุดูุฑ ุฎุงูุตุงู ูููุ ุฌู ุซูุงุคู ุฏูู ุณุงุฆุฑ ูุง ูุนุจุฏ ูู ุฏูููุ ุจูุง ุฃูุนู ุนูู ุนุจุงุฏู ูู ุงููุนู.'
        }
      }
    };

    const tafsir = tafsirs[tafsirSource]?.[surahNumber]?.[ayahNumber];
    
    if (tafsir) {
      return {
        surah: surahNumber,
        ayah: ayahNumber,
        source: tafsirSource,
        text: tafsir
      };
    }

    return null;
  }

  /**
   * Get hadith by category
   */
  static async getHadith(category = 'ุฅููุงู') {
    const ahadith = [
      {
        id: 1,
        category: 'ุฅููุงู',
        text: 'ุนู ุนูุฑ ุจู ุงูุฎุทุงุจ ุฑุถู ุงููู ุนูู ูุงู: ุจูููุง ูุญู ุฌููุณ ุนูุฏ ุฑุณูู ุงููู ุตูู ุงููู ุนููู ูุณูู ุฐุงุช ูููุ ุฅุฐ ุทูุน ุนูููุง ุฑุฌู ุดุฏูุฏ ุจูุงุถ ุงูุซูุงุจ...',
        explanation: 'ูุฐุง ุญุฏูุซ ุฌุจุฑูู ุงูุดููุฑ ุงูุฐู ููู ุจูุงู ุฃุฑูุงู ุงูุฅุณูุงู ูุงูุฅููุงู ูุงูุฅุญุณุงู',
        source: 'ุตุญูุญ ูุณูู',
        narrator: 'ุนูุฑ ุจู ุงูุฎุทุงุจ',
        grade: 'ุตุญูุญ'
      },
      {
        id: 2,
        category: 'ุฃุฎูุงู',
        text: 'ุนู ุฃุจู ูุฑูุฑุฉ ุฑุถู ุงููู ุนูู ูุงู: ูุงู ุฑุณูู ุงููู ุตูู ุงููู ุนููู ูุณูู: "ุงููุคูู ุงูููู ุฎูุฑ ูุฃุญุจ ุฅูู ุงููู ูู ุงููุคูู ุงูุถุนูู ููู ูู ุฎูุฑ"',
        explanation: 'ุงูุญุซ ุนูู ุงูููุฉ ูู ุฌููุน ุฃููุฑ ุงูุฏููุง ูุงูุฏูู',
        source: 'ุตุญูุญ ูุณูู',
        narrator: 'ุฃุจู ูุฑูุฑุฉ',
        grade: 'ุตุญูุญ'
      },
      {
        id: 3,
        category: 'ุนุจุงุฏุฉ',
        text: 'ุนู ุนุงุฆุดุฉ ุฑุถู ุงููู ุนููุง ูุงูุช: ูุงู ุฑุณูู ุงููู ุตูู ุงููู ุนููู ูุณูู ุฅุฐุง ุฏุฎู ุงูุนุดุฑ ุฃุญูู ุงูููู ูุฃููุธ ุฃููู ูุดุฏ ูุฆุฒุฑู',
        explanation: 'ุงุณุชุญุจุงุจ ุงูุงุฌุชูุงุฏ ูู ุงูุนุจุงุฏุฉ ูู ุงูุนุดุฑ ุงูุฃูุงุฎุฑ ูู ุฑูุถุงู',
        source: 'ุตุญูุญ ุงูุจุฎุงุฑู',
        narrator: 'ุนุงุฆุดุฉ',
        grade: 'ุตุญูุญ'
      },
      {
        id: 4,
        category: 'ุฏุนุงุก',
        text: 'ุนู ุงุจู ุนุจุงุณ ูุงู ุงููุจู ุตูู ุงููู ุนููู ูุณูู: "ุณููุง ุงููู ุงูุนุงููุฉ ูุฅูู ูู ูุคุช ุฃุญุฏ ุจุนุฏ ุงููููู ุฎูุฑุงู ูู ุงูุนุงููุฉ"',
        explanation: 'ูุถู ุณุคุงู ุงููู ุงูุนุงููุฉ ูุงูุญุซ ุนูููุง',
        source: 'ุณูู ุงูุชุฑูุฐู',
        narrator: 'ุงุจู ุนุจุงุณ',
        grade: 'ุญุณู'
      },
      {
        id: 5,
        category: 'ูุนุงููุงุช',
        text: 'ุนู ุงููุนูุงู ุจู ุจุดูุฑ ูุงู: ูุงู ุฑุณูู ุงููู ุตูู ุงููู ุนููู ูุณูู: "ูุซู ุงููุคูููู ูู ุชูุงุฏูู ูุชุฑุงุญููู ูุชุนุงุทููู ูุซู ุงูุฌุณุฏ ุฅุฐุง ุงุดุชูู ููู ุนุถู ุชุฏุงุนู ูู ุณุงุฆุฑ ุงูุฌุณุฏ ุจุงูุณูุฑ ูุงูุญูู"',
        explanation: 'ุจูุงู ุนุธู ุญู ุงููุณูู ุนูู ุงููุณูู ููุฌูุจ ุงูุชุนุงูู ูุงูุชุฑุงุญู',
        source: 'ุตุญูุญ ูุณูู',
        narrator: 'ุงููุนูุงู ุจู ุจุดูุฑ',
        grade: 'ุตุญูุญ'
      }
    ];

    const filtered = category === 'all' 
      ? ahadith 
      : ahadith.filter(h => h.category === category);

    return filtered[Math.floor(Math.random() * filtered.length)];
  }

  /**
   * Get stories from Quran
   */
  static async getQuranStory(storyName) {
    const stories = {
      'ููุณู': {
        title: 'ูุตุฉ ููุณู ุนููู ุงูุณูุงู',
        summary: 'ูุตุฉ ูุจู ุงููู ููุณู ูู ููุงุฏุชู ุฅูู ุฏุนูุชู ูุฑุนูู ูุฎุฑูุฌ ุจูู ุฅุณุฑุงุฆูู ูู ูุตุฑ',
        mainEvents: [
          '๐ผ ููุงุฏุฉ ููุณู ูุฅููุงุคู ูู ุงููู',
          '๐ฅ ูุตุฉ ุงูุนูููุฉ ุงููุดุชุนูุฉ ูุงููุญู',
          'โก ุงูููุงุฌูุฉ ูุน ูุฑุนูู ูุงููุนุฌุฒุงุช',
          '๐ ุดู ุงูุจุญุฑ ููุฌุงุฉ ุจูู ุฅุณุฑุงุฆูู',
          '๐ ุชููู ุงูุฃููุงุญ ุนูู ุฌุจู ุงูุทูุฑ'
        ],
        lessons: [
          'ุงูุชููู ุนูู ุงููู ูู ุฃุดุฏ ุงูุฃููุงุช',
          'ุงูุตุจุฑ ุนูู ุงูุจูุงุก ูุงูุซุจุงุช ุนูู ุงูุญู',
          'ูุฏุฑุฉ ุงููู ูู ูุตุฑ ุงููุณุชุถุนููู'
        ],
        verses: 'ุณูุฑุฉ ุงููุตุต: 1-43ุ ุณูุฑุฉ ุทู: 9-98'
      },
      'ููุณู': {
        title: 'ูุตุฉ ููุณู ุนููู ุงูุณูุงู',
        summary: 'ูู ุฑุคูุง ููุณู ุฅูู ุชูููู ุฎุฒุงุฆู ูุตุฑ ูููุงุฆู ุจุฅุฎูุชู',
        mainEvents: [
          '๐ ุฑุคูุง ููุณู ูุญุณุฏ ุฅุฎูุชู',
          '๐ณ๏ธ ุฅููุงุคู ูู ุงูุจุฆุฑ ูุจูุนู',
          '๐๏ธ ูู ุจูุช ุงูุนุฒูุฒ ููุญูุฉ ุงูุฑุฃุฉ ุงูุนุฒูุฒ',
          'โ๏ธ ุงูุณุฌู ูุชูุณูุฑ ุงูุฃุญูุงู',
          '๐ ุชููู ุฎุฒุงุฆู ูุตุฑ ูููุงุก ุงูุฅุฎูุฉ'
        ],
        lessons: [
          'ุงูุตุจุฑ ุนูู ุงูุงุจุชูุงุก',
          'ุงูุนูู ูุงููุณุงูุญุฉ',
          'ุญุณู ุงูุธู ุจุงููู'
        ],
        verses: 'ุณูุฑุฉ ููุณู: ูุงููุฉ'
      },
      'ููุญ': {
        title: 'ูุตุฉ ููุญ ุนููู ุงูุณูุงู',
        summary: 'ุฏุนูุฉ ููุญ ููููู 950 ุนุงูุงู ูุงูุทููุงู ุงูุนุธูู',
        mainEvents: [
          '๐ฃ ุฏุนูุฉ ูููู ุฅูู ุงูุชูุญูุฏ',
          '๐ ุฅุนุฑุงุถ ุงูููู ูุงูุงุณุชูุจุงุฑ',
          'โ๏ธ ุจูุงุก ุงูุณูููุฉ ุจุฃูุฑ ุงููู',
          '๐ ุงูุทููุงู ูููุงู ุงููุงูุฑูู',
          '๐๏ธ ุฌูุฏู ููุฌุงุฉ ุงููุคูููู'
        ],
        lessons: [
          'ุงูุตุจุฑ ูู ุงูุฏุนูุฉ',
          'ุนุงูุจุฉ ุงูููุฑ ูุงูุงุณุชูุจุงุฑ',
          'ุฑุญูุฉ ุงููู ุจุงููุคูููู'
        ],
        verses: 'ุณูุฑุฉ ููุญุ ุณูุฑุฉ ููุฏ: 25-49'
      }
    };

    return stories[storyName] || null;
  }

  /**
   * Biography of Companions (Sahaba)
   */
  static async getSahabiBiography(name) {
    const sahaba = {
      'ุฃุจู ุจูุฑ': {
        name: 'ุฃุจู ุจูุฑ ุงูุตุฏูู',
        fullName: 'ุนุจุฏ ุงููู ุจู ุนุซูุงู ุจู ุนุงูุฑ',
        title: 'ุงูุตุฏูู',
        description: 'ุฃูู ุงูุฎููุงุก ุงูุฑุงุดุฏูู ูุฃูู ูู ุฃุณูู ูู ุงูุฑุฌุงู',
        virtues: [
          '๐ ุฃูุถู ุงูุตุญุงุจุฉ ุจุนุฏ ุงููุจู',
          '๐ช ูุตุฑุฉ ุงูุฅุณูุงู ุจูุงูู ูููุณู',
          '๐ ุฅูุงูุฉ ุงููุณูููู ุจุนุฏ ุงููุจู',
          '๐ ุฌูุน ุงููุฑุขู ูู ุนูุฏู'
        ],
        famousStories: [
          'ุตุญุจุชู ูููุจู ูู ุงููุฌุฑุฉ',
          'ูุชุงูู ูููุฑุชุฏูู',
          'ููููู ููู ููุงุฉ ุงููุจู'
        ],
        death: 'ุชููู ุณูุฉ 13 ูู'
      },
      'ุนูุฑ': {
        name: 'ุนูุฑ ุจู ุงูุฎุทุงุจ',
        fullName: 'ุนูุฑ ุจู ุงูุฎุทุงุจ ุจู ูููู',
        title: 'ุงููุงุฑูู',
        description: 'ุซุงูู ุงูุฎููุงุก ุงูุฑุงุดุฏููุ ุฃุนุฒ ุงููู ุจู ุงูุฅุณูุงู',
        virtues: [
          'โ๏ธ ุงูุนุฏู ูุงูุฅูุตุงู',
          '๐บ๏ธ ุงููุชูุญุงุช ุงูุฅุณูุงููุฉ ุงููุจุฑู',
          '๐ ุชูุธูู ุงูุฏููุฉ ุงูุฅุณูุงููุฉ',
          '๐ก ุงููุฑุงุณุฉ ูุงูุญููุฉ'
        ],
        famousStories: [
          'ุฅุณูุงูู ูุนุฒ ุงูุฅุณูุงู',
          'ูุชุญ ุจูุช ุงูููุฏุณ',
          'ุนุงู ุงูุฑูุงุฏุฉ ูุฌูุฏู'
        ],
        death: 'ุงุณุชุดูุฏ ุณูุฉ 23 ูู'
      }
    };

    return sahaba[name] || null;
  }

  /**
   * Islamic Jurisprudence (Fiqh)
   */
  static async getFiqhRuling(topic) {
    const fiqh = {
      'ุงูุทูุงุฑุฉ': {
        title: 'ุฃุญูุงู ุงูุทูุงุฑุฉ',
        definition: 'ุงูุทูุงุฑุฉ: ุงููุธุงูุฉ ูุงูุฎูู ูู ุงููุฌุงุณุฉ ูุงูุญุฏุซ',
        types: [
          '๐ง ุทูุงุฑุฉ ุญุณูุฉ: ุฅุฒุงูุฉ ุงููุฌุงุณุฉ',
          'โจ ุทูุงุฑุฉ ูุนูููุฉ: ุงููุถูุก ูุงูุบุณู'
        ],
        conditions: [
          'ุงูููุฉ',
          'ุงููุงุก ุงูุทููุฑ',
          'ุฅุฒุงูุฉ ูุง ูููุน ูุตูู ุงููุงุก'
        ],
        evidences: [
          'ูุงู ุชุนุงูู: "ููุง ุฃููููููุง ุงูููุฐูููู ุขูููููุง ุฅูุฐูุง ููููุชููู ุฅูููู ุงูุตููููุงุฉู ููุงุบูุณููููุง ููุฌูููููููู"',
          'ูุงู ุงููุจู ๏ทบ: "ุงูุทููุฑ ุดุทุฑ ุงูุฅููุงู"'
        ]
      },
      'ุงูุตูุงุฉ': {
        title: 'ุฃุญูุงู ุงูุตูุงุฉ',
        definition: 'ุงูุตูุงุฉ: ุนุจุงุฏุฉ ุฐุงุช ุฃููุงู ูุฃูุนุงู ูุฎุตูุตุฉุ ููุชุชุญุฉ ุจุงูุชูุจูุฑ ูุฎุชุชูุฉ ุจุงูุชุณููู',
        pillars: [
          '1. ุงูููุงู ูุน ุงููุฏุฑุฉ',
          '2. ุชูุจูุฑุฉ ุงูุฅุญุฑุงู',
          '3. ูุฑุงุกุฉ ุงููุงุชุญุฉ',
          '4. ุงูุฑููุน',
          '5. ุงูุฑูุน ููู',
          '6. ุงูุณุฌูุฏ',
          '7. ุงูุฌููุณ ุจูู ุงูุณุฌุฏุชูู',
          '8. ุงูุทูุฃูููุฉ',
          '9. ุงูุชุดูุฏ ุงูุฃุฎูุฑ',
          '10. ุงูุฌููุณ ูู',
          '11. ุงูุตูุงุฉ ุนูู ุงููุจู',
          '12. ุงูุชุณููู',
          '13. ุงูุชุฑุชูุจ'
        ],
        conditions: [
          'ุงูุฅุณูุงู',
          'ุงูุนูู',
          'ุงูุชูููุฒ',
          'ุฏุฎูู ุงูููุช',
          'ุงูุทูุงุฑุฉ ูู ุงูุญุฏุซ ูุงูุฎุจุซ',
          'ุณุชุฑ ุงูุนูุฑุฉ',
          'ุงุณุชูุจุงู ุงููุจูุฉ',
          'ุงูููุฉ'
        ]
      },
      'ุงูุฒูุงุฉ': {
        title: 'ุฃุญูุงู ุงูุฒูุงุฉ',
        definition: 'ุงูุฒูุงุฉ: ุญู ูุงุฌุจ ูู ูุงู ุฎุงุต ูุทุงุฆูุฉ ูุฎุตูุตุฉ ูู ููุช ูุฎุตูุต',
        nisab: {
          'ุฐูุจ': '85 ุฌุฑุงูุงู',
          'ูุถุฉ': '595 ุฌุฑุงูุงู',
          'ูููุฏ': 'ูุง ูุนุงุฏู ูููุฉ ุฃุญุฏููุง',
          'ุฒุฑูุน': '5 ุฃูุณู (653 ูุบ)'
        },
        percentage: '2.5% (ุฑุจุน ุงูุนุดุฑ) ูู ุงููุงู ูุงูุชุฌุงุฑุฉ',
        recipients: [
          '1. ุงูููุฑุงุก',
          '2. ุงููุณุงููู',
          '3. ุงูุนุงูููู ุนูููุง',
          '4. ุงููุคููุฉ ูููุจูู',
          '5. ูู ุงูุฑูุงุจ',
          '6. ุงูุบุงุฑููู',
          '7. ูู ุณุจูู ุงููู',
          '8. ุงุจู ุงูุณุจูู'
        ]
      }
    };

    return fiqh[topic] || null;
  }

  /**
   * Format library content
   */
  static formatLibraryContent(type, data) {
    if (!data) return 'โ ูู ูุชู ุงูุนุซูุฑ ุนูู ุงููุญุชูู';

    let message = '';

    switch (type) {
      case 'tafsir':
        message = `๐ <b>ุชูุณูุฑ - ${data.source}</b>\n\n`;
        message += `๐ ุณูุฑุฉ ${data.surah} - ุขูุฉ ${data.ayah}\n\n`;
        message += `${data.text}`;
        break;

      case 'hadith':
        message = `๐ฟ <b>ุญุฏูุซ ุดุฑูู</b>\n\n`;
        message += `<b>ุงููุชู:</b>\n${data.text}\n\n`;
        message += `<b>ุงูุฑุงูู:</b> ${data.narrator}\n`;
        message += `<b>ุงููุตุฏุฑ:</b> ${data.source}\n`;
        message += `<b>ุงูุฏุฑุฌุฉ:</b> ${data.grade}\n\n`;
        message += `<b>ุงูุดุฑุญ:</b>\n${data.explanation}`;
        break;

      case 'story':
        message = `๐ <b>${data.title}</b>\n\n`;
        message += `<b>ุงูููุฎุต:</b>\n${data.summary}\n\n`;
        message += `<b>ุงูุฃุญุฏุงุซ ุงูุฑุฆูุณูุฉ:</b>\n`;
        data.mainEvents.forEach(event => message += `${event}\n`);
        message += `\n<b>ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ:</b>\n`;
        data.lessons.forEach(lesson => message += `โข ${lesson}\n`);
        message += `\n<b>ุงูุขูุงุช:</b> ${data.verses}`;
        break;

      case 'sahabi':
        message = `๐ค <b>${data.name}</b>\n`;
        message += `<i>${data.title}</i>\n\n`;
        message += `<b>ุงูุงุณู ุงููุงูู:</b> ${data.fullName}\n\n`;
        message += `<b>ูุจุฐุฉ:</b> ${data.description}\n\n`;
        message += `<b>ุงููุถุงุฆู:</b>\n`;
        data.virtues.forEach(v => message += `${v}\n`);
        message += `\n<b>ูุตุต ูุดููุฑุฉ:</b>\n`;
        data.famousStories.forEach(s => message += `โข ${s}\n`);
        message += `\n<b>ุงูููุงุฉ:</b> ${data.death}`;
        break;

      case 'fiqh':
        message = `โ๏ธ <b>${data.title}</b>\n\n`;
        message += `<b>ุงูุชุนุฑูู:</b> ${data.definition}\n\n`;
        
        if (data.pillars) {
          message += `<b>ุงูุฃุฑูุงู:</b>\n`;
          data.pillars.forEach(p => message += `${p}\n`);
          message += `\n`;
        }
        
        if (data.conditions) {
          message += `<b>ุงูุดุฑูุท:</b>\n`;
          data.conditions.forEach(c => message += `โข ${c}\n`);
          message += `\n`;
        }
        
        if (data.types) {
          message += `<b>ุงูุฃููุงุน:</b>\n`;
          data.types.forEach(t => message += `${t}\n`);
        }
        break;
    }

    return message;
  }
}

module.exports = IslamicLibrary;
